#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/stat.h>
#include "shuffle.h"
#include <dlfcn.h>
#include <unistd.h>
#include <stdint.h>
#include <errno.h>
#include <string.h>
#include <math.h>
#include <sys/mman.h>
#include <fcntl.h>
#include <signal.h>
#include <assert.h>
int correct_func[1500];
char base[15]; // base 
long int GOT_offset[1500] = {0};

long base_num = 0x0;
long* addr_dest;
long long int charArray_to_num(char *addr){
    long long int num = 0x0;
    int i = 0;
    while (addr[i] != '\0'){
        if(addr[i] - '0' >= 0 && addr[i] - '0' <= 9){
            num = 16 * num + (addr[i] - '0');
        }else{
            num = 16 * num + (10 + (addr[i] - 'a'));
        }
        i++;
    }
    return num;
}

void init(){
    // return;
    
    memset(correct_func, -1, sizeof(correct_func));
    for(int i = 0; i < 1477; i++){
        correct_func[ndat[i]] = i;
    }
    printf("debug1\n");
    memset(GOT_offset, -1, sizeof(GOT_offset));
    
    GOT_offset[606] = 0x17a30;
    GOT_offset[641] = 0x17a38;
    GOT_offset[175] = 0x17a40;
    GOT_offset[1272] = 0x17a48;
    GOT_offset[1276] = 0x17a50;
    GOT_offset[286] = 0x17a58;
    GOT_offset[249] = 0x17a60;
    GOT_offset[502] = 0x17a68;
    GOT_offset[284] = 0x17a70;
    GOT_offset[208] = 0x17a78;
    GOT_offset[280] = 0x17a80;
    GOT_offset[541] = 0x17a88;
    GOT_offset[206] = 0x17a90;
    GOT_offset[786] = 0x17a98;
    GOT_offset[1237] = 0x17aa0;
    GOT_offset[1008] = 0x17aa8;
    GOT_offset[788] = 0x17ab0;
    GOT_offset[704] = 0x17ab8;
    GOT_offset[741] = 0x17ac0;
    GOT_offset[1045] = 0x17ac8;
    GOT_offset[1235] = 0x17ad0;
    GOT_offset[738] = 0x17ad8;
    GOT_offset[706] = 0x17ae0;
    GOT_offset[1239] = 0x17ae8;
    GOT_offset[1152] = 0x17af0;
    GOT_offset[849] = 0x17af8;
    GOT_offset[775] = 0x17b00;
    GOT_offset[1004] = 0x17b08;
    GOT_offset[1193] = 0x17b10;
    GOT_offset[1156] = 0x17b18;
    GOT_offset[771] = 0x17b20;
    GOT_offset[1191] = 0x17b28;
    GOT_offset[200] = 0x17b30;
    GOT_offset[380] = 0x17b38;
    GOT_offset[1309] = 0x17b40;
    GOT_offset[1136] = 0x17b48;
    GOT_offset[847] = 0x17b50;
    GOT_offset[877] = 0x17b58;
    GOT_offset[808] = 0x17b60;
    GOT_offset[57] = 0x17b68;
    GOT_offset[1132] = 0x17b70;
    GOT_offset[1134] = 0x17b78;
    GOT_offset[841] = 0x17b80;
    GOT_offset[1348] = 0x17b88;
    GOT_offset[1346] = 0x17b90;
    GOT_offset[10] = 0x17b98;
    GOT_offset[1291] = 0x17ba0;
    GOT_offset[884] = 0x17ba8;
    GOT_offset[1293] = 0x17bb0;
    GOT_offset[1385] = 0x17bb8;
    GOT_offset[300] = 0x17bc0;
    GOT_offset[473] = 0x17bc8;
    GOT_offset[1250] = 0x17bd0;
    GOT_offset[304] = 0x17bd8;
    GOT_offset[949] = 0x17be0;
    GOT_offset[1254] = 0x17be8;
    GOT_offset[1217] = 0x17bf0;
    GOT_offset[1446] = 0x17bf8;
    GOT_offset[1409] = 0x17c00;
    GOT_offset[1256] = 0x17c08;
    GOT_offset[947] = 0x17c10;
    GOT_offset[1219] = 0x17c18;
    GOT_offset[1407] = 0x17c20;
    GOT_offset[1215] = 0x17c28;
    GOT_offset[1448] = 0x17c30;
    GOT_offset[945] = 0x17c38;
    GOT_offset[908] = 0x17c40;
    GOT_offset[906] = 0x17c48;
    GOT_offset[943] = 0x17c50;
    GOT_offset[96] = 0x17c58;
    GOT_offset[986] = 0x17c60;
    GOT_offset[1213] = 0x17c68;
    GOT_offset[180] = 0x17c70;
    GOT_offset[1211] = 0x17c78;
    GOT_offset[141] = 0x17c80;
    GOT_offset[591] = 0x17c88;
    GOT_offset[558] = 0x17c90;
    GOT_offset[108] = 0x17c98;
    GOT_offset[519] = 0x17ca0;
    GOT_offset[556] = 0x17ca8;
    GOT_offset[432] = 0x17cb0;
    GOT_offset[1186] = 0x17cb8;
    GOT_offset[597] = 0x17cc0;
    GOT_offset[147] = 0x17cc8;
    GOT_offset[1149] = 0x17cd0;
    GOT_offset[430] = 0x17cd8;
    GOT_offset[92] = 0x17ce0;
    GOT_offset[1147] = 0x17ce8;
    GOT_offset[182] = 0x17cf0;
    GOT_offset[145] = 0x17cf8;
    GOT_offset[631] = 0x17d00;
    GOT_offset[1188] = 0x17d08;
    GOT_offset[149] = 0x17d10;
    GOT_offset[186] = 0x17d18;
    GOT_offset[1284] = 0x17d20;
    GOT_offset[684] = 0x17d28;
    GOT_offset[238] = 0x17d30;
    GOT_offset[680] = 0x17d38;
    GOT_offset[511] = 0x17d40;
    GOT_offset[273] = 0x17d48;
    GOT_offset[234] = 0x17d50;
    GOT_offset[102] = 0x17d58;
    GOT_offset[271] = 0x17d60;
    GOT_offset[550] = 0x17d68;
    GOT_offset[513] = 0x17d70;
    GOT_offset[799] = 0x17d78;
    GOT_offset[711] = 0x17d80;
    GOT_offset[1019] = 0x17d88;
    GOT_offset[1421] = 0x17d90;
    GOT_offset[28] = 0x17d98;
    GOT_offset[26] = 0x17da0;
    GOT_offset[782] = 0x17da8;
    GOT_offset[1184] = 0x17db0;
    GOT_offset[1015] = 0x17db8;
    GOT_offset[1011] = 0x17dc0;
    GOT_offset[1013] = 0x17dc8;
    GOT_offset[391] = 0x17dd0;
    GOT_offset[317] = 0x17dd8;
    GOT_offset[315] = 0x17de0;
    GOT_offset[230] = 0x17de8;
    GOT_offset[866] = 0x17df0;
    GOT_offset[1332] = 0x17df8;
    GOT_offset[834] = 0x17e00;
    GOT_offset[20] = 0x17e08;
    GOT_offset[22] = 0x17e10;
    GOT_offset[1082] = 0x17e18;
    GOT_offset[871] = 0x17e20;
    GOT_offset[873] = 0x17e28;
    GOT_offset[1260] = 0x17e30;
    GOT_offset[1379] = 0x17e38;
    GOT_offset[1338] = 0x17e40;
    GOT_offset[1221] = 0x17e48;
    GOT_offset[429] = 0x17e50;
    GOT_offset[466] = 0x17e58;
    GOT_offset[1084] = 0x17e60;
    GOT_offset[1373] = 0x17e68;
    GOT_offset[427] = 0x17e70;
    GOT_offset[313] = 0x17e78;
    GOT_offset[311] = 0x17e80;
    GOT_offset[1377] = 0x17e88;
    GOT_offset[1225] = 0x17e90;
    GOT_offset[921] = 0x17e98;
    GOT_offset[1418] = 0x17ea0;
    GOT_offset[1451] = 0x17ea8;
    GOT_offset[1049] = 0x17eb0;
    GOT_offset[1414] = 0x17eb8;
    GOT_offset[953] = 0x17ec0;
    GOT_offset[1160] = 0x17ec8;
    GOT_offset[990] = 0x17ed0;
    GOT_offset[157] = 0x17ed8;
    GOT_offset[568] = 0x17ee0;
    GOT_offset[1457] = 0x17ee8;
    GOT_offset[1121] = 0x17ef0;
    GOT_offset[155] = 0x17ef8;
    GOT_offset[566] = 0x17f00;
    GOT_offset[67] = 0x17f08;
    GOT_offset[153] = 0x17f10;
    GOT_offset[114] = 0x17f18;
    GOT_offset[529] = 0x17f20;
    GOT_offset[527] = 0x17f28;
    GOT_offset[112] = 0x17f30;
    GOT_offset[562] = 0x17f38;
    GOT_offset[460] = 0x17f40;
    GOT_offset[61] = 0x17f48;
    GOT_offset[421] = 0x17f50;
    GOT_offset[1175] = 0x17f58;
    GOT_offset[639] = 0x17f60;
    GOT_offset[676] = 0x17f68;
    GOT_offset[159] = 0x17f70;
    GOT_offset[620] = 0x17f78;
    GOT_offset[637] = 0x17f80;
    GOT_offset[674] = 0x17f88;
    GOT_offset[635] = 0x17f90;
    GOT_offset[624] = 0x17f98;
    GOT_offset[1313] = 0x17fa0;
    GOT_offset[1179] = 0x17fa8;
    GOT_offset[261] = 0x17fb0;
    GOT_offset[226] = 0x17fb8;
    GOT_offset[224] = 0x17fc8;
    GOT_offset[1258] = 0x17fd0;
    GOT_offset[758] = 0x17fd8;
    GOT_offset[720] = 0x17fe0;
    GOT_offset[1026] = 0x17fe8;
    GOT_offset[523] = 0x17ff0;
    GOT_offset[1067] = 0x17ff8;
    GOT_offset[756] = 0x18000;
    GOT_offset[265] = 0x18008;
    GOT_offset[754] = 0x18010;
    GOT_offset[719] = 0x18018;
    GOT_offset[1063] = 0x18020;
    GOT_offset[761] = 0x18028;
    GOT_offset[717] = 0x18030;
    GOT_offset[269] = 0x18038;
    GOT_offset[797] = 0x18040;
    GOT_offset[4] = 0x18048;
    GOT_offset[328] = 0x18050;
    GOT_offset[326] = 0x18058;
    GOT_offset[222] = 0x18060;
    GOT_offset[829] = 0x18068;
    GOT_offset[898] = 0x18070;
    GOT_offset[1114] = 0x18078;
    GOT_offset[369] = 0x18080;
    GOT_offset[220] = 0x18088;
    GOT_offset[827] = 0x18090;
    GOT_offset[367] = 0x18098;
    GOT_offset[1321] = 0x180a0;
    GOT_offset[825] = 0x180a8;
    GOT_offset[851] = 0x180b0;
    GOT_offset[814] = 0x180b8;
    GOT_offset[2] = 0x180c0;
    GOT_offset[1360] = 0x180c8;
    GOT_offset[823] = 0x180d0;
    GOT_offset[33] = 0x180d8;
    GOT_offset[1093] = 0x180e0;
    GOT_offset[1232] = 0x180e8;
    GOT_offset[862] = 0x180f0;
    GOT_offset[864] = 0x180f8;
    GOT_offset[1362] = 0x18100;
    GOT_offset[457] = 0x18108;
    GOT_offset[1230] = 0x18110;
    GOT_offset[1097] = 0x18118;
    GOT_offset[860] = 0x18120;
    GOT_offset[1095] = 0x18128;
    GOT_offset[492] = 0x18130;
    GOT_offset[418] = 0x18138;
    GOT_offset[416] = 0x18140;
    GOT_offset[451] = 0x18148;
    GOT_offset[1056] = 0x18150;
    GOT_offset[1423] = 0x18158;
    GOT_offset[1368] = 0x18160;
    GOT_offset[320] = 0x18168;
    GOT_offset[1234] = 0x18170;
    GOT_offset[929] = 0x18178;
    GOT_offset[498] = 0x18180;
    GOT_offset[1099] = 0x18188;
    GOT_offset[927] = 0x18190;
    GOT_offset[925] = 0x18198;
    GOT_offset[1464] = 0x181a0;
    GOT_offset[1468] = 0x181a8;
    GOT_offset[129] = 0x181b0;
    GOT_offset[960] = 0x181b8;
    GOT_offset[1110] = 0x181c0;
    GOT_offset[164] = 0x181c8;
    GOT_offset[577] = 0x181d0;
    GOT_offset[76] = 0x181d8;
    GOT_offset[538] = 0x181e0;
    GOT_offset[575] = 0x181e8;
    GOT_offset[160] = 0x181f0;
    GOT_offset[573] = 0x181f8;
    GOT_offset[70] = 0x18200;
    GOT_offset[412] = 0x18208;
    GOT_offset[1306] = 0x18210;
    GOT_offset[698] = 0x18218;
    GOT_offset[651] = 0x18220;
    GOT_offset[1125] = 0x18228;
    GOT_offset[628] = 0x18230;
    GOT_offset[663] = 0x18238;
    GOT_offset[1300] = 0x18240;
    GOT_offset[1129] = 0x18248;
    GOT_offset[661] = 0x18250;
    GOT_offset[1304] = 0x18258;
    GOT_offset[299] = 0x18260;
    GOT_offset[254] = 0x18268;
    GOT_offset[1266] = 0x18270;
    GOT_offset[1264] = 0x18278;
    GOT_offset[534] = 0x18280;
    GOT_offset[571] = 0x18288;
    GOT_offset[769] = 0x18290;
    GOT_offset[776] = 0x18298;
    GOT_offset[1074] = 0x182a0;
    GOT_offset[293] = 0x182a8;
    GOT_offset[532] = 0x182b0;
    GOT_offset[1406] = 0x182b8;
    GOT_offset[291] = 0x182c0;
    GOT_offset[1268] = 0x182c8;
    GOT_offset[47] = 0x182d0;
    GOT_offset[1072] = 0x182d8;
    GOT_offset[728] = 0x182e0;
    GOT_offset[1035] = 0x182e8;
    GOT_offset[1229] = 0x182f0;
    GOT_offset[726] = 0x182f8;
    GOT_offset[6] = 0x18300;
    GOT_offset[1166] = 0x18308;
    GOT_offset[1400] = 0x18310;
    GOT_offset[374] = 0x18318;
    GOT_offset[339] = 0x18320;
    GOT_offset[337] = 0x18328;
    GOT_offset[801] = 0x18330;
    GOT_offset[1144] = 0x18338;
    GOT_offset[1107] = 0x18340;
    GOT_offset[1356] = 0x18348;
    GOT_offset[857] = 0x18350;
    GOT_offset[1354] = 0x18358;
    GOT_offset[1317] = 0x18360;
    GOT_offset[45] = 0x18368;
    GOT_offset[1142] = 0x18370;
    GOT_offset[805] = 0x18378;
    GOT_offset[1105] = 0x18380;
    GOT_offset[855] = 0x18388;
    GOT_offset[43] = 0x18390;
    GOT_offset[853] = 0x18398;
    GOT_offset[816] = 0x183a0;
    GOT_offset[894] = 0x183a8;
    GOT_offset[896] = 0x183b0;
    GOT_offset[1103] = 0x183b8;
    GOT_offset[892] = 0x183c0;
    GOT_offset[1391] = 0x183c8;
    GOT_offset[1101] = 0x183d0;
    GOT_offset[448] = 0x183d8;
    GOT_offset[446] = 0x183e0;
    GOT_offset[409] = 0x183e8;
    GOT_offset[1399] = 0x183f0;
    GOT_offset[407] = 0x183f8;
    GOT_offset[1434] = 0x18400;
    GOT_offset[1069] = 0x18408;
    GOT_offset[333] = 0x18410;
    GOT_offset[1246] = 0x18418;
    GOT_offset[1395] = 0x18428;
    GOT_offset[331] = 0x18430;
    GOT_offset[989] = 0x18438;
    GOT_offset[901] = 0x18440;
    GOT_offset[1471] = 0x18448;
    GOT_offset[933] = 0x18450;
    GOT_offset[903] = 0x18458;
    GOT_offset[1242] = 0x18460;
    GOT_offset[1203] = 0x18468;
    GOT_offset[489] = 0x18470;
    GOT_offset[1436] = 0x18478;
    GOT_offset[1473] = 0x18480;
    GOT_offset[974] = 0x18488;
    GOT_offset[970] = 0x18490;
    GOT_offset[1475] = 0x18498;
    GOT_offset[583] = 0x184a0;
    GOT_offset[133] = 0x184a8;
    GOT_offset[548] = 0x184b0;
    GOT_offset[581] = 0x184b8;
    GOT_offset[546] = 0x184c0;
    GOT_offset[84] = 0x184c8;
    GOT_offset[1140] = 0x184d0;
    GOT_offset[509] = 0x184d8;
    GOT_offset[601] = 0x184e0;
    GOT_offset[139] = 0x184e8;
    GOT_offset[687] = 0x184f0;
    GOT_offset[440] = 0x184f8;
    GOT_offset[403] = 0x18500;
    GOT_offset[1116] = 0x18508;
    GOT_offset[659] = 0x18510;
    GOT_offset[1331] = 0x18518;
    GOT_offset[642] = 0x18520;
    GOT_offset[607] = 0x18528;
    GOT_offset[657] = 0x18530;
    GOT_offset[176] = 0x18538;
    GOT_offset[1273] = 0x18540;
    GOT_offset[692] = 0x18548;
    GOT_offset[285] = 0x18550;
    GOT_offset[248] = 0x18558;
    GOT_offset[1040] = 0x18568;
    GOT_offset[283] = 0x18570;
    GOT_offset[244] = 0x18578;
    GOT_offset[501] = 0x18580;
    GOT_offset[242] = 0x18588;
    GOT_offset[739] = 0x18590;
    GOT_offset[785] = 0x18598;
    GOT_offset[505] = 0x185a0;
    GOT_offset[701] = 0x185a8;
    GOT_offset[287] = 0x185b0;
    GOT_offset[787] = 0x185b8;
    GOT_offset[1279] = 0x185c0;
    GOT_offset[58] = 0x185c8;
    GOT_offset[1007] = 0x185d0;
    GOT_offset[772] = 0x185d8;
    GOT_offset[1001] = 0x185e0;
    GOT_offset[1151] = 0x185e8;
    GOT_offset[50] = 0x185f0;
    GOT_offset[1192] = 0x185f8;
    GOT_offset[240] = 0x18600;
    GOT_offset[203] = 0x18608;
    GOT_offset[307] = 0x18610;
    GOT_offset[15] = 0x18618;
    GOT_offset[201] = 0x18620;
    GOT_offset[876] = 0x18628;
    GOT_offset[1194] = 0x18630;
    GOT_offset[1345] = 0x18638;
    GOT_offset[1137] = 0x18640;
    GOT_offset[56] = 0x18648;
    GOT_offset[1308] = 0x18650;
    GOT_offset[1133] = 0x18658;
    GOT_offset[1347] = 0x18660;
    GOT_offset[807] = 0x18668;
    GOT_offset[842] = 0x18670;
    GOT_offset[885] = 0x18678;
    GOT_offset[1198] = 0x18680;
    GOT_offset[1388] = 0x18688;
    GOT_offset[1380] = 0x18690;
    GOT_offset[439] = 0x18698;
    GOT_offset[437] = 0x186a0;
    GOT_offset[470] = 0x186a8;
    GOT_offset[433] = 0x186b0;
    GOT_offset[1445] = 0x186b8;
    GOT_offset[340] = 0x186c0;
    GOT_offset[1255] = 0x186c8;
    GOT_offset[1218] = 0x186d0;
    GOT_offset[1386] = 0x186d8;
    GOT_offset[956] = 0x186e0;
    GOT_offset[946] = 0x186e8;
    GOT_offset[993] = 0x186f0;
    GOT_offset[1212] = 0x186f8;
    GOT_offset[944] = 0x18700;
    GOT_offset[995] = 0x18708;
    GOT_offset[97] = 0x18710;
    GOT_offset[1251] = 0x18718;
    GOT_offset[1253] = 0x18720;
    GOT_offset[983] = 0x18728;
    GOT_offset[95] = 0x18730;
    GOT_offset[985] = 0x18738;
    GOT_offset[144] = 0x18740;
    GOT_offset[981] = 0x18748;
    GOT_offset[142] = 0x18750;
    GOT_offset[109] = 0x18758;
    GOT_offset[590] = 0x18760;
    GOT_offset[557] = 0x18768;
    GOT_offset[518] = 0x18770;
    GOT_offset[598] = 0x18778;
    GOT_offset[185] = 0x18780;
    GOT_offset[1148] = 0x18788;
    GOT_offset[630] = 0x18790;
    GOT_offset[183] = 0x18798;
    GOT_offset[648] = 0x187a0;
    GOT_offset[632] = 0x187a8;
    GOT_offset[189] = 0x187b0;
    GOT_offset[634] = 0x187b8;
    GOT_offset[646] = 0x187c0;
    GOT_offset[1189] = 0x187c8;
    GOT_offset[1090] = 0x187d0;
    GOT_offset[609] = 0x187d8;
    GOT_offset[683] = 0x187e0;
    GOT_offset[685] = 0x187e8;
    GOT_offset[1283] = 0x187f0;
    GOT_offset[1051] = 0x187f8;
    GOT_offset[235] = 0x18800;
    GOT_offset[512] = 0x18808;
    GOT_offset[272] = 0x18810;
    GOT_offset[1285] = 0x18818;
    GOT_offset[101] = 0x18820;
    GOT_offset[551] = 0x18828;
    GOT_offset[710] = 0x18830;
    GOT_offset[748] = 0x18838;
    GOT_offset[278] = 0x18840;
    GOT_offset[239] = 0x18848;
    GOT_offset[712] = 0x18850;
    GOT_offset[709] = 0x18858;
    GOT_offset[1287] = 0x18860;
    GOT_offset[25] = 0x18868;
    GOT_offset[744] = 0x18870;
    GOT_offset[707] = 0x18878;
    GOT_offset[1016] = 0x18880;
    GOT_offset[1185] = 0x18888;
    GOT_offset[1012] = 0x18890;
    GOT_offset[783] = 0x18898;
    GOT_offset[396] = 0x188a0;
    GOT_offset[318] = 0x188a8;
    GOT_offset[355] = 0x188b0;
    GOT_offset[27] = 0x188b8;
    GOT_offset[1333] = 0x188c0;
    GOT_offset[23] = 0x188c8;
    GOT_offset[1337] = 0x188d0;
    GOT_offset[822] = 0x188d8;
    GOT_offset[1370] = 0x188e0;
    GOT_offset[1335] = 0x188e8;
    GOT_offset[872] = 0x188f0;
    GOT_offset[1374] = 0x188f8;
    GOT_offset[1085] = 0x18900;
    GOT_offset[870] = 0x18908;
    GOT_offset[469] = 0x18910;
    GOT_offset[467] = 0x18918;
    GOT_offset[351] = 0x18920;
    GOT_offset[919] = 0x18928;
    GOT_offset[1413] = 0x18930;
    GOT_offset[920] = 0x18938;
    GOT_offset[1450] = 0x18940;
    GOT_offset[969] = 0x18948;
    GOT_offset[1415] = 0x18950;
    GOT_offset[999] = 0x18958;
    GOT_offset[952] = 0x18960;
    GOT_offset[954] = 0x18968;
    GOT_offset[117] = 0x18970;
    GOT_offset[567] = 0x18978;
    GOT_offset[1120] = 0x18980;
    GOT_offset[154] = 0x18988;
    GOT_offset[950] = 0x18990;
    GOT_offset[115] = 0x18998;
    GOT_offset[1454] = 0x189a0;
    GOT_offset[1419] = 0x189a8;
    GOT_offset[152] = 0x189b0;
    GOT_offset[528] = 0x189b8;
    GOT_offset[563] = 0x189c0;
    GOT_offset[113] = 0x189c8;
    GOT_offset[111] = 0x189d0;
    GOT_offset[561] = 0x189d8;
    GOT_offset[62] = 0x189e0;
    GOT_offset[424] = 0x189e8;
    GOT_offset[461] = 0x189f0;
    GOT_offset[1351] = 0x189f8;
    GOT_offset[621] = 0x18a00;
    GOT_offset[677] = 0x18a08;
    GOT_offset[158] = 0x18a10;
    GOT_offset[1316] = 0x18a18;
    GOT_offset[1353] = 0x18a20;
    GOT_offset[569] = 0x18a28;
    GOT_offset[660] = 0x18a30;
    GOT_offset[199] = 0x18a38;
    GOT_offset[1312] = 0x18a40;
    GOT_offset[636] = 0x18a48;
    GOT_offset[1176] = 0x18a50;
    GOT_offset[1310] = 0x18a58;
    GOT_offset[262] = 0x18a60;
    GOT_offset[520] = 0x18a68;
    GOT_offset[260] = 0x18a70;
    GOT_offset[757] = 0x18a78;
    GOT_offset[1027] = 0x18a80;
    GOT_offset[1259] = 0x18a88;
    GOT_offset[1021] = 0x18a90;
    GOT_offset[718] = 0x18a98;
    GOT_offset[753] = 0x18aa0;
    GOT_offset[716] = 0x18aa8;
    GOT_offset[751] = 0x18ab0;
    GOT_offset[1023] = 0x18ab8;
    GOT_offset[760] = 0x18ac0;
    GOT_offset[1064] = 0x18ac8;
    GOT_offset[794] = 0x18ad0;
    GOT_offset[796] = 0x18ad8;
    GOT_offset[329] = 0x18ae0;
    GOT_offset[5] = 0x18ae8;
    GOT_offset[360] = 0x18af0;
    GOT_offset[38] = 0x18af8;
    GOT_offset[897] = 0x18b00;
    GOT_offset[368] = 0x18b08;
    GOT_offset[221] = 0x18b10;
    GOT_offset[1115] = 0x18b18;
    GOT_offset[828] = 0x18b20;
    GOT_offset[366] = 0x18b28;
    GOT_offset[1] = 0x18b30;
    GOT_offset[1363] = 0x18b38;
    GOT_offset[3] = 0x18b40;
    GOT_offset[811] = 0x18b48;
    GOT_offset[1326] = 0x18b50;
    GOT_offset[850] = 0x18b58;
    GOT_offset[1361] = 0x18b60;
    GOT_offset[1324] = 0x18b68;
    GOT_offset[1365] = 0x18b70;
    GOT_offset[30] = 0x18b78;
    GOT_offset[865] = 0x18b80;
    GOT_offset[497] = 0x18b88;
    GOT_offset[1231] = 0x18b90;
    GOT_offset[321] = 0x18b98;
    GOT_offset[1424] = 0x18ba0;
    GOT_offset[499] = 0x18ba8;
    GOT_offset[1055] = 0x18bb0;
    GOT_offset[1422] = 0x18bb8;
    GOT_offset[930] = 0x18bc0;
    GOT_offset[1059] = 0x18bc8;
    GOT_offset[1426] = 0x18bd0;
    GOT_offset[924] = 0x18bd8;
    GOT_offset[961] = 0x18be0;
    GOT_offset[963] = 0x18be8;
    GOT_offset[1469] = 0x18bf0;
    GOT_offset[77] = 0x18bf8;
    GOT_offset[1098] = 0x18c00;
    GOT_offset[1461] = 0x18c08;
    GOT_offset[1111] = 0x18c10;
    GOT_offset[163] = 0x18c18;
    GOT_offset[126] = 0x18c20;
    GOT_offset[539] = 0x18c28;
    GOT_offset[576] = 0x18c30;
    GOT_offset[1463] = 0x18c38;
    GOT_offset[537] = 0x18c40;
    GOT_offset[124] = 0x18c48;
    GOT_offset[574] = 0x18c50;
    GOT_offset[411] = 0x18c58;
    GOT_offset[73] = 0x18c60;
    GOT_offset[572] = 0x18c68;
    GOT_offset[75] = 0x18c70;
    GOT_offset[450] = 0x18c78;
    GOT_offset[415] = 0x18c80;
    GOT_offset[1126] = 0x18c88;
    GOT_offset[71] = 0x18c90;
    GOT_offset[1467] = 0x18c98;
    GOT_offset[169] = 0x18ca0;
    GOT_offset[413] = 0x18ca8;
    GOT_offset[697] = 0x18cb0;
    GOT_offset[1342] = 0x18cb8;
    GOT_offset[167] = 0x18cc0;
    GOT_offset[650] = 0x18cc8;
    GOT_offset[613] = 0x18cd0;
    GOT_offset[1169] = 0x18cd8;
    GOT_offset[699] = 0x18ce0;
    GOT_offset[629] = 0x18ce8;
    GOT_offset[1128] = 0x18cf0;
    GOT_offset[662] = 0x18cf8;
    GOT_offset[1263] = 0x18d00;
    GOT_offset[290] = 0x18d08;
    GOT_offset[218] = 0x18d10;
    GOT_offset[533] = 0x18d18;
    GOT_offset[120] = 0x18d20;
    GOT_offset[777] = 0x18d28;
    GOT_offset[259] = 0x18d30;
    GOT_offset[531] = 0x18d38;
    GOT_offset[766] = 0x18d40;
    GOT_offset[729] = 0x18d48;
    GOT_offset[779] = 0x18d50;
    GOT_offset[257] = 0x18d58;
    GOT_offset[1226] = 0x18d60;
    GOT_offset[1032] = 0x18d68;
    GOT_offset[764] = 0x18d70;
    GOT_offset[1071] = 0x18d78;
    GOT_offset[1034] = 0x18d80;
    GOT_offset[762] = 0x18d88;
    GOT_offset[48] = 0x18d90;
    GOT_offset[1401] = 0x18d98;
    GOT_offset[1073] = 0x18da0;
    GOT_offset[1163] = 0x18da8;
    GOT_offset[7] = 0x18db0;
    GOT_offset[1167] = 0x18db8;
    GOT_offset[1269] = 0x18dc0;
    GOT_offset[1165] = 0x18dc8;
    GOT_offset[338] = 0x18dd0;
    GOT_offset[334] = 0x18dd8;
    GOT_offset[1318] = 0x18de0;
    GOT_offset[1355] = 0x18de8;
    GOT_offset[212] = 0x18df0;
    GOT_offset[377] = 0x18df8;
    GOT_offset[800] = 0x18e00;
    GOT_offset[856] = 0x18e08;
    GOT_offset[375] = 0x18e10;
    GOT_offset[1390] = 0x18e18;
    GOT_offset[817] = 0x18e20;
    GOT_offset[854] = 0x18e28;
    GOT_offset[852] = 0x18e30;
    GOT_offset[1143] = 0x18e38;
    GOT_offset[1359] = 0x18e40;
    GOT_offset[1106] = 0x18e48;
    GOT_offset[1398] = 0x18e50;
    GOT_offset[44] = 0x18e58;
    GOT_offset[1280] = 0x18e60;
    GOT_offset[893] = 0x18e68;
    GOT_offset[1396] = 0x18e70;
    GOT_offset[1282] = 0x18e78;
    GOT_offset[1394] = 0x18e80;
    GOT_offset[891] = 0x18e88;
    GOT_offset[482] = 0x18e90;
    GOT_offset[480] = 0x18e98;
    GOT_offset[408] = 0x18ea0;
    GOT_offset[332] = 0x18ea8;
    GOT_offset[988] = 0x18eb0;
    GOT_offset[900] = 0x18eb8;
    GOT_offset[330] = 0x18ec0;
    GOT_offset[1206] = 0x18ec8;
    GOT_offset[902] = 0x18ed0;
    GOT_offset[1247] = 0x18ed8;
    GOT_offset[1068] = 0x18ee0;
    GOT_offset[936] = 0x18ee8;
    GOT_offset[1208] = 0x18ef0;
    GOT_offset[1433] = 0x18ef8;
    GOT_offset[1243] = 0x18f00;
    GOT_offset[1204] = 0x18f08;
    GOT_offset[1437] = 0x18f10;
    GOT_offset[932] = 0x18f18;
    GOT_offset[1182] = 0x18f20;
    GOT_offset[87] = 0x18f28;
    GOT_offset[977] = 0x18f30;
    GOT_offset[1202] = 0x18f38;
    GOT_offset[179] = 0x18f40;
    GOT_offset[971] = 0x18f48;
    GOT_offset[134] = 0x18f50;
    GOT_offset[584] = 0x18f58;
    GOT_offset[1180] = 0x18f60;
    GOT_offset[1200] = 0x18f68;
    GOT_offset[132] = 0x18f70;
    GOT_offset[545] = 0x18f78;
    GOT_offset[508] = 0x18f80;
    GOT_offset[543] = 0x18f88;
    GOT_offset[443] = 0x18f90;
    GOT_offset[406] = 0x18f98;
    GOT_offset[1117] = 0x18fa0;
    GOT_offset[81] = 0x18fa8;
    GOT_offset[173] = 0x18fb0;
    GOT_offset[1476] = 0x18fb8;
    GOT_offset[171] = 0x18fc0;
    GOT_offset[688] = 0x18fc8;

    ////////////////////////////////////
    long int max_off = 0x0, min_off = 0x25000;
    for(int i = 0; i < 1477; i++) {
        if(GOT_offset[i] > max_off) max_off = GOT_offset[i];
        if(GOT_offset[i] < min_off && GOT_offset[i] != -1) min_off = GOT_offset[i];
    }

    printf("debug2\n");
    FILE* fp = fopen("/proc/self/maps", "r");
	if(fp){
        {
            char buf[1500];
            fseek(fp, 0, SEEK_SET);
            fread(base, 12, 1, fp);
            base[12] = '\0';
            printf("%s\n", base);
            base_num = strtol(base, NULL, 16);
            printf("temp = %lx\n", base_num);
        }
        {
            //////////////////////////////////
            fseek(fp, 0, SEEK_SET);
            
            char* line = NULL;
            size_t len = 0;
            ssize_t nread = -1;
            int cnt = 0;
            
            size_t got_min = -1, got_max = 0;
            for (int i = 0; i < 1477; i++){
                if (GOT_offset[i] == -1)
                    continue;
                
                size_t got = base_num + GOT_offset[i];
                got_min = got < got_min ? got : got_min;
                got_max = got > got_max ? got : got_max;
            }

            while ((nread = getline(&line, &len, fp)) != -1){
                
                size_t start, end;
                if(sscanf(line, "%lx-%lx", &start, &end) != 2) continue;;
                if(strstr(line, "/chal") != NULL){
                    printf("line: %s", line);
                    size_t got_498 = base_num + GOT_offset[498];
                    if (!(got_min >= end || got_max < start) && mprotect(start, end - start, PROT_READ | PROT_WRITE | PROT_EXEC) == -1) {
                        perror("mprotect");
                        exit(0);
                    }
                }
                
                cnt++;
            }
        }
        
	}else{
        perror("File /proc/self/maps Error\n");
        exit(0);
    }

    size_t page_size = sysconf(_SC_PAGESIZE);
    int num_page = (max_off - min_off) / page_size;
    if(max_off-min_off % page_size){
        num_page += 1;
    }
    printf("number of pages = %d\n", num_page);
    printf("trimmed start addr %lx\n", (base_num + min_off) - ((base_num + min_off)) % page_size);
    printf("page size %ld\n", page_size);
    
    void *handle = dlopen("libpoem.so", RTLD_NOW);
    if(!handle){
        fprintf(stderr, "%s\n", dlerror());
        exit(1);
    }
    
    for(int i = 0; i < 1477; i++){
        if(GOT_offset[i] == -1) continue;
        printf("*i=%d\n", i);
        char func_name[15];
        func_name[0] = 'c'; func_name[1] = 'o'; func_name[2] = 'd'; func_name[3] = 'e'; func_name[4] = '_';
        int j = correct_func[i];
        if(j < 10) func_name[5] = '0' + j, func_name[6] = '\0';
        else if(j < 100) func_name[5] = '0' + (j / 10), func_name[6] = '0' + (j % 10), func_name[7] = '\0';
        else if(j < 1000) {
            func_name[5] = '0' + (j / 100);
            func_name[6] = '0' + ((j % 100) / 10);
            func_name[7] = '0' + ((j % 100) % 10);
            func_name[8] = '\0';
        }else{
            func_name[5] = '0' + (j / 1000);
            func_name[6] = '0' + ((j % 1000) / 100);
            func_name[7] = '0' + (((j % 1000) % 100) / 10);
            func_name[8] = '0' + (((j % 1000) % 100) % 10);
            func_name[9] = '\0';
        }
        
        printf("func name %s\n", func_name);
        void (*func_addr) = dlsym(handle, func_name); // the address of the correct function
        if(!func_addr){
            perror("dlsym error\n");
            exit(0);
        }
        printf("correct func loc = %p\n", func_addr);
        printf("debug3\n");
        
        long temp = base_num + GOT_offset[i];
        long* addr_dest = (long*)temp;
        
        printf("addr_dest content = %p\n", addr_dest);
        if( addr_dest == NULL ){
            continue;
        }
        printf("Value stored in the pointer: %ld\n", *(unsigned long int*)addr_dest);
        *addr_dest = func_addr;
        printf("after reassigning = %lx\n", *addr_dest);
        printf("----------------\n");
        
    }

}